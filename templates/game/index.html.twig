{% extends 'base.html.twig' %}

{% block title %}Hello GameController!{% endblock %}

{% block navprofil %}
    <ul class="navbar-nav justify-content-end">
        {% if user == null %}
            <li class="nav-item">
                <a class="nav-link" href="{{ path('login') }}" aria-disabled="true">Login</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="{{ path('register') }}" aria-disabled="true">Register</a>
            </li>
        {% endif %}
        {% if user %}
            <ul class="navbar-nav justify-content-end">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="myprofil" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Mon profil
                    </a>
                    <div class="dropdown-menu" aria-labelledby="myprofil">
                        <a class="dropdown-item" href="#">{{ user.prenom }} {{ user.nom }}</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="{{ path('logout') }}" aria-disabled="true">Logout</a>
                    </div>
                </li>
            </ul>
        {% endif %}
    </ul>
{% endblock %}

{% block body %}
<style>
<<<<<<< HEAD
    .body-wrapper { 
        margin: 1em auto; 
        max-width: 800px; 
        width: 95%; 
        font: 18px/1.5 sans-serif;
        display: flex;
        flex-direction: row;
        justify-content: space-evenly;
    }
    h1, h2 {
        text-align: center;
    },
    chat {
        padding: 10px;
    }
    chat-btn{
        display: flex;
        flex-direction: row;
        justify-content: space-evenly;
    }
    scenario{
        padding: 10px;
    }
    scenario-btn{
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }
</style>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


<div>
    <h1>Page de jeu</h1>
    <div class="body-wrapper">
        <div class="chat">
            <h2>Chat</h2>
            <div> 
                <h4> Messages </h4>
            </div>
            <div class="chat-btn">
                <input type="text" placeholder="Tapez message ici " />
                <button id="send">BOUTON 1</button>
            </div>
        </div>
        
        <div class="scenario">
            <h2>Scénario</h2>
            <div id="scenario-context" class="context">
            </div>
            <div id="scenario-btn" class="scenario-btn">
            </div>
        </div>
    </div>
=======
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<section class="container">
<div class="row">
<div class="col-md-2">
<h5>liste des aventures en cours</h5>
>>>>>>> 90413bc2519d07d04f90a87a43ada03828a7648d
</div>
<div class="col-md-8">

<<<<<<< HEAD
<script>
    var COMPAIGN = {
        "1": {
            "context": "Vous entrez dans une caverne, vos yeux s'habituent tout juste à l'obscurité, que faites vous ?",
            "buttons": [
                {
                    "id": 1,
                    "text": "On fouille",
                    "link": "2",
                },
                {
                    "id": 2,
                    "text": "On sort",
                    "link": "3",
                },
                {
                    "id": 3,
                    "text": "On fonce",
                    "link": "4",
                },
            ],
        },
        "2": {
            "context": "Il y a des chauves souris et un ruisseau proches de vous, plus loin la caverne continue, où allez vous ?",
            "buttons": [
                {
                    "id": 1,
                    "text": "Proche des chauves-souris",
                    "link": "7",
                },
                {
                    "id": 2,
                    "text": "Proche du ruisseau",
                    "link": "8",
                },
                {
                    "id": 3,
                    "text": "On continue la caverne",
                    "link": "4",
                },
            ],
        },
        "3": {
            "context": "Avez vous si peur que ça ? il n'y a rien dehors, que faites vous ?",
            "buttons": [
                {
                    "id": 1,
                    "text": "On retourne dans la caverne",
                    "link": "1",
                },
                {
                    "id": 2,
                    "text": "Abandonner",
                    "link": "-1",
                }
             ],
        },
        "4": {
            "context": "Alors que vous avancez dans la caverne, vous voyez un trésor au loin, que faites vous",
            "buttons": [
                {
                    "id": 4,
                    "text": "C'est surement un piege, on fait demi tour",
                    "link": "2",
                },
                {
                    "id": 5,
                    "text": "On l'ouvre !",
                    "link": "6",
                },
            ],
        },
        "6": {
            "context": "Vous etes riches, Bravo",
            "buttons": [
                {
                    "id": 5,
                    "text": "Terminer",
                    "link": "-1",
                },
            ],
        },
        "7": {
            "context": "Une des chauves souris s'envole vers l'extérieur de la caverne, que faites vous ?",
            "buttons": [
                {
                    "id": 1,
                    "text": "On sort avec la chauve souris",
                    "link": "3",
                },
                {
                    "id": 2,
                    "text": "On continue de fouiller",
                    "link": "2",
                },
            ],
        },
        "8": {
            "context": "Une carcasse de chevreuil est étendue au fond du ruisseau, que faites vous ?",
            "buttons": [
                {
                    "id": 1,
                    "text": "On fouille la carcasse",
                    "link": "9",
                },
                {
                    "id": 2,
                    "text": "On continue de fouiller la caverne",
                    "link": "2",
                },
            ],
        },
        "9": {
            "context": "Des traces de crocs acérés montrent que cette carcasse a été dévorée par un loup, que faites vous ?",
            "buttons": [
                {
                    "id": 1,
                    "text": "On avance dans la caverne ! si il ya un loup, nous le tuerons !",
                    "link": "4",
                },
                {
                    "id": 2,
                    "text": "On continue de fouiller la caverne",
                    "link": "2",
                },
                {
                    "id": 2,
                    "text": "Un loup ? fuions !",
                    "link": "3",
                },
            ],
        }


    };

    $(function() {
        $('#send').click(function() {
            $.ajax({
                url : "/game/chat.php" + premierID, // on passe l'id le plus récent au fichier de chargement
                type : "GET",
                data : {"pseudo": pseudo,"message": message},
                success : function(html){
                    $('#messages').prepend(html);
                }
            });    
        });  
    });

    function reload(){
        setTimeout(function(){
            var premierID = $('#messages p:first').attr('id'); // on récupère l'id le plus récent
            $.ajax({
                url : "/game/chat.php?id=" + premierID, // on passe l'id le plus récent au fichier de chargement
                type : "GET",
                success : function(html){
                    $('#messages').prepend(html);
                }
            });
            reload();
        }, 1000);

    }

    function fill_context(id){
        var element = document.getElementById("scenario-context");
        if(id == "-1"){
            element.innerHTML = "Terminé";
            return false;
        }
        element.innerHTML = "<p> " + COMPAIGN[id]["context"] + "</p>";
    }

    function fill_buttons(id){
        
        var element = document.getElementById("scenario-btn");
        var html = ""
        if(id == "-1"){
            element.innerHTML = "";
            return false;
        }
        COMPAIGN[id]["buttons"].forEach(function(item){
            html = html + '<button id="'+ item["id"]+ '" onclick="fill_game_scenario(' + item["link"] + ')">' + item["text"] + '</button>';
        });
        element.innerHTML = html;
    }

    function fill_game_scenario(id){
        fill_context(id);
        fill_buttons(id); 
    }

    //reload();
    fill_game_scenario("1");
</script>

{% endblock %}
=======
</div>
<div class="col-md-2">
<h5>liste des badges</h5>
</div>
</section>
{% endblock %}  
>>>>>>> 90413bc2519d07d04f90a87a43ada03828a7648d
